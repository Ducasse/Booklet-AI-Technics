\pagelayout{\paperbackpage}

\usepackage{_support/latex/sbabook/pharo-titlepage}

\usepackage{polyglossia}
\usepackage[normalem]{ulem} % for strikeout text (\sout{...})
\usepackage{graphicx}

% for math
\usepackage{amsmath}
\usepackage{amssymb}

% for pseudocode
\usepackage[ruled,vlined]{algorithm2e}
\usepackage[T1]{fontenc}

\SetAlgorithmName{Function}{function}{List of Functions}
\SetKwInput{KwData}{Input}
\SetKwInput{KwResult}{Output}
\SetKwProg{Fn}{Function}{}{}

% for example boxes
\usepackage{tcolorbox}
\usepackage[framemethod=TikZ]{mdframed}

% for landscape images
\usepackage{rotating}

\usepackage{url} % define and apply style to URLs
\def\url@sfstyle{\def\UrlFont{\sf}}
\urlstyle{sf}
\usepackage[
  unicode,
  breaklinks, hidelinks, % undecorated hyperlinks
  bookmarks, bookmarksdepth = subsubsection
]{hyperref}

% Lulu only supports PDF format version 1.3
% Since we use lualatex to compile, we need to use this command
% https://tex.stackexchange.com/questions/374991/lualatex-and-pdfminorversion
\directlua{pdf.setminorversion(3)}

\usepackage{multicol}
\usepackage{multirow}

% a nice horizontal separator
\newcommand{\sectionline}{%
  \begin{center}\nointerlineskip
    \rule{0.233\linewidth}{.7pt}%
  \end{center}
}

% less space around lists
\tightlists

% showing code, inline and as blocks
\usepackage{lstsmalltalk}
\usepackage{lsthttp}
\lstdefinelanguage{plain}{}% verbatim, plain text

\lstalias{Pillar}{plain}
\lstalias{CSS}{plain}
\lstalias{JSON}{plain}
\lstalias{STON}{plain}
\lstalias{Javascript}{plain}
\lstalias{ShellCommands}{plain}

\lstset{
  language = smalltalk,
  tabsize = 3
}

% highlighted paragraphs
\newenvironment{note}{%
  \begin{leftbar}\textsf{\textbf{Note}}\quad
}{\end{leftbar}}

\newenvironment{todo}{%
  \begin{leftbar}\textsf{\textbf{To do}}\quad
}{\end{leftbar}}

\newenvironment{important}{%
  \begin{leftbar}\textsf{\textbf{Important}}\quad
}{\end{leftbar}}

% example boxes
\newcounter{example}[chapter]\setcounter{example}{0}
\renewcommand{\theexample}{\arabic{chapter}.\arabic{example}}

\newenvironment{example}{
  \refstepcounter{example}
  \mdfsetup{%
  frametitle={%
  \tikz[baseline=(current bounding box.east),outer sep=0pt]
  \node[anchor=east,rectangle,fill=green!20]
  {\strut Example~\theexample};}}
  \mdfsetup{innertopmargin=10pt,innerbottommargin=10pt,linecolor=green!20,%
  linewidth=2pt,topline=true,%
  frametitleaboveskip=\dimexpr-\ht\strutbox\relax
  }
  \begin{mdframed}
}{
  \end{mdframed}
}

\newcounter{lem}[section]\setcounter{lem}{0}
\renewcommand{\thelem}{\arabic{section}.\arabic{lem}}
\newenvironment{lem}[2][]{%
\refstepcounter{lem}%
\ifstrempty{#1}%
{\mdfsetup{%
frametitle={%
\tikz[baseline=(current bounding box.east),outer sep=0pt]
\node[anchor=east,rectangle,fill=green!20]
{\strut Lemma~\thelem};}}
}%
{\mdfsetup{%
frametitle={%
\tikz[baseline=(current bounding box.east),outer sep=0pt]
\node[anchor=east,rectangle,fill=green!20]
{\strut Lemma~\thetheo:~#1};}}%
}%
\mdfsetup{innertopmargin=10pt,linecolor=green!20,%
linewidth=2pt,topline=true,%
frametitleaboveskip=\dimexpr-\ht\strutbox\relax
}
\begin{mdframed}[]\relax%
\label{#2}}{\end{mdframed}}
